(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2422"],{"2b45":function(e,t,s){"use strict";var r=s("d3a0"),a=s.n(r);a.a},"49c1":function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Poptip",{attrs:{trigger:"hover",transfer:"",placement:"right-start",title:"消息体格式",width:"400"}},[s("Icon",{attrs:{type:"md-help-circle",size:"22",color:"#2d8cf0"}}),s("div",{staticStyle:{height:"300px"},attrs:{slot:"content"},slot:"content"},[s("pre",[e._v(e._s(JSON.stringify(JSON.parse('{"entityType":"1","entityId":"480068","messageType":1}'),null,2))+"\n"),s("br"),s("strong",[e._v("messageType: ")]),e._v("消息类型\n"),s("strong",[e._v("枚举: ")]),e._v(e._s(e.messageTypes)+"\n"),s("br"),s("strong",[e._v("entityType: ")]),e._v("实体类型\n"),s("strong",[e._v("枚举: ")]),e._v(e._s(e.entityTypes)+"\n"),s("br"),s("strong",[e._v("entityId: ")]),e._v(" 实体id，根据entityType取商品id、合同id等;\n           如果是sku类型，可用逗号拼接多个商品编码\n")])])],1)},a=[],n=(s("456d"),s("ac6a"),s("2a92")),o={data:function(){return{entityTypes:JSON.stringify(n["entityTypes"],null,2),messageTypes:JSON.stringify(this.transferKV(n["messageTypes"]),null,2)}},methods:{transferKV:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return Object.keys(e).forEach(function(s){return t[e[s]]=s}),t}}},i=o,l=s("2877"),c=Object(l["a"])(i,r,a,!1,null,null,null);c.options.__file="msgTips.vue";t["default"]=c.exports},d3a0:function(e,t,s){},e95e:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Row",[s("Col",{attrs:{span:"15"}},[s("Card",[s("Tabs",{on:{"on-click":e.tabsChange},model:{value:e.form.entityType,callback:function(t){e.$set(e.form,"entityType",t)},expression:"form.entityType"}},[s("TabPane",{attrs:{label:"sku维度",name:e.entityTypes.skuIds}},[s("Form",{ref:"skuForm",attrs:{model:e.form,rules:e.rules,"label-width":90}},[s("Row",[s("Col",{attrs:{span:"17"}},[s("FormItem",{attrs:{label:"消息类型",prop:"messageType"}},[s("AutoSelect",{attrs:{mapper:e.messageTypes,number:""},model:{value:e.form.messageType,callback:function(t){e.$set(e.form,"messageType",t)},expression:"form.messageType"}})],1)],1),s("Col",{attrs:{span:"2"}},[s("FormItem",{attrs:{label:"JSON格式"}},[s("AutoSwitch",{attrs:{text:"是|否",value:e.isJson?1:0},on:{"on-change":e.changeJsonType}})],1)],1),s("Col",{attrs:{span:"1"}},[s("FormItem",[s("MsgTips")],1)],1)],1),e.isJson?e._e():s("div",[s("FormItem",{attrs:{label:"商品编码",prop:"skuIds"}},[s("Input",{staticStyle:{width:"435px"},attrs:{placeholder:"请输入商品编码, 多个编码请用英文逗号隔开"},model:{value:e.form.skuIds,callback:function(t){e.$set(e.form,"skuIds",t)},expression:"form.skuIds"}})],1)],1),e.isJson?s("FormItem",{attrs:{label:"JSON消息",prop:"messageText"}},[s("Input",{attrs:{type:"textarea",autosize:{minRows:10,maxRows:15},placeholder:"请输入JSON格式消息..."},on:{"on-change":e.msgTextChange},model:{value:e.form.messageText,callback:function(t){e.$set(e.form,"messageText",t)},expression:"form.messageText"}})],1):e._e(),s("FormItem",[s("AutoButton",{attrs:{type:"primary",load:e.onOk,valid:""}},[e._v("发送")]),s("Button",{staticStyle:{"margin-left":"8px"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1),s("TabPane",{attrs:{label:"合同维度",name:e.entityTypes.contractNO}},[s("Form",{ref:"contractForm",attrs:{model:e.form,rules:e.rules,"label-width":90}},[s("Row",[s("Col",{attrs:{span:"17"}},[s("FormItem",{attrs:{label:"消息类型",prop:"messageType"}},[s("AutoSelect",{attrs:{mapper:e.messageTypes,number:""},model:{value:e.form.messageType,callback:function(t){e.$set(e.form,"messageType",t)},expression:"form.messageType"}})],1)],1),s("Col",{attrs:{span:"2"}},[s("FormItem",{attrs:{label:"JSON格式"}},[s("AutoSwitch",{attrs:{text:"是|否",value:e.isJson?1:0},on:{"on-change":e.changeJsonType}})],1)],1),s("Col",{attrs:{span:"1"}},[s("FormItem",[s("MsgTips")],1)],1)],1),e.isJson?e._e():s("div",[s("FormItem",{attrs:{label:"合同号",prop:"contractNO"}},[s("Input",{staticStyle:{width:"435px"},attrs:{placeholder:"请输入合同号",clearable:""},model:{value:e.form.contractNO,callback:function(t){e.$set(e.form,"contractNO",t)},expression:"form.contractNO"}})],1)],1),e.isJson?s("FormItem",{attrs:{label:"JSON消息",prop:"messageText"}},[s("Input",{attrs:{type:"textarea",autosize:{minRows:10,maxRows:15},placeholder:"请输入JSON格式消息..."},on:{"on-change":e.msgTextChange},model:{value:e.form.messageText,callback:function(t){e.$set(e.form,"messageText",t)},expression:"form.messageText"}})],1):e._e(),s("FormItem",[s("AutoButton",{attrs:{type:"primary",load:e.onOk,valid:""}},[e._v("发送")]),s("Button",{staticStyle:{"margin-left":"8px"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1),s("TabPane",{attrs:{label:"商品池维度",name:e.entityTypes.skuPool}},[s("Form",{ref:"poolForm",attrs:{model:e.form,rules:e.rules,"label-width":90}},[s("Row",[s("Col",{attrs:{span:"17"}},[s("FormItem",{attrs:{label:"消息类型",prop:"messageType"}},[s("AutoSelect",{attrs:{mapper:e.messageTypes,number:""},model:{value:e.form.messageType,callback:function(t){e.$set(e.form,"messageType",t)},expression:"form.messageType"}})],1)],1),s("Col",{attrs:{span:"2"}},[s("FormItem",{attrs:{label:"JSON格式"}},[s("AutoSwitch",{attrs:{text:"是|否",value:e.isJson?1:0},on:{"on-change":e.changeJsonType}})],1)],1),s("Col",{attrs:{span:"1"}},[s("FormItem",[s("MsgTips")],1)],1)],1),e.isJson?e._e():s("div",[s("FormItem",{attrs:{label:"商品池ID",prop:"skuPool"}},[s("InputNumber",{staticStyle:{width:"435px"},attrs:{placeholder:"请输入商品池id",max:999999999999,min:1},model:{value:e.form.skuPool,callback:function(t){e.$set(e.form,"skuPool",t)},expression:"form.skuPool"}})],1)],1),e.isJson?s("FormItem",{attrs:{label:"JSON消息",prop:"messageText"}},[s("Input",{attrs:{type:"textarea",autosize:{minRows:10,maxRows:15},placeholder:"请输入JSON格式消息..."},on:{"on-change":e.msgTextChange},model:{value:e.form.messageText,callback:function(t){e.$set(e.form,"messageText",t)},expression:"form.messageText"}})],1):e._e(),s("FormItem",[s("AutoButton",{attrs:{type:"primary",load:e.onOk,valid:""}},[e._v("发送")]),s("Button",{staticStyle:{"margin-left":"8px"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1),s("TabPane",{attrs:{label:"商品组维度",name:"name4"}},[e._v("标签四的内容")]),s("TabPane",{attrs:{label:"全量同步",name:e.entityTypes.syncAll}},[s("Form",{ref:"syncForm",attrs:{model:e.syncForm,rules:e.syncRules,"label-width":120}},[s("Row",[s("Col",{attrs:{span:"8"}},[s("FormItem",{attrs:{label:"上次中断SKU："}},[e._v("\n                      "+e._s(e.syncForm.lastSku)+"\n                    ")])],1),s("Col",{attrs:{span:"8"}},[s("FormItem",{attrs:{label:"中断前已同步数量："}},[e._v("\n                      "+e._s(e.syncForm.syncNums)+"\n                    ")])],1),s("Col",{attrs:{span:"8"}},[s("FormItem",{attrs:{label:"是否接上一次同步",prop:"isGoOn"}},[s("AutoSwitch",{attrs:{text:"是|否",trueValue:!0,falseValue:!1},model:{value:e.syncForm.isGoOn,callback:function(t){e.$set(e.syncForm,"isGoOn",t)},expression:"syncForm.isGoOn"}})],1)],1)],1),s("Row",[s("Col",{attrs:{span:"23"}},[s("FormItem",{attrs:{label:"选择消息(多选)",prop:"syncMsgTypes"}},[s("AutoSelect",{attrs:{mapper:e.messageTypes,multiple:"",number:""},model:{value:e.syncForm.syncMsgTypes,callback:function(t){e.$set(e.syncForm,"syncMsgTypes",t)},expression:"syncForm.syncMsgTypes"}})],1)],1),s("Col",{attrs:{span:"1"}},[s("Poptip",{staticStyle:{"margin-top":"5px","margin-left":"5px"},attrs:{trigger:"hover",transfer:"",placement:"right-start",title:"全量同步"}},[s("Icon",{attrs:{type:"md-help-circle",size:"22",color:"#2d8cf0"}}),s("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n                        可以选择多个消息类型"),s("br"),e._v("\n                        系统会把商品池中全量的商品按照选择的消息推送到搜索中台\n                      ")])],1)],1)],1),e.isProgress?s("div",[s("FormItem",{attrs:{label:"任务进度"}},[s("Progress",{attrs:{percent:e.percent,status:"active"}}),s("div",{domProps:{innerHTML:e._s(e.hunmanProgressDesc)}})],1)],1):e._e(),s("FormItem",[s("AutoButton",{attrs:{type:"warning",load:e.syncAll,valid:"",placement:"right"}},[e._v("全量同步")])],1)],1)],1),s("TabPane",{attrs:{label:"刷新商品类目",name:"name5"}},[s("Alert",{attrs:{"show-icon":""}},[e._v("\n                全量刷新商品类目\n                "),s("template",{slot:"desc"},[e._v(" 系统全量缓存了商品类目信息，每隔12小时自动刷新一次，同时提供了手动刷新的功能，点击【全量刷新】按钮手动刷新。 ")])],2),s("AutoButton",{attrs:{type:"warning",load:e.refreshSkuCategory,placement:"right"}},[e._v("全量刷新")])],1)],1)],1)],1)],1)},a=[],n=(s("6762"),s("2fdb"),s("28a5"),s("ac6a"),s("456d"),s("7514"),s("c93e")),o=(s("96cf"),s("3040")),i=(s("a481"),s("2a92")),l=s("c276"),c=s("49c1"),m={components:{MsgTips:c["default"]},data:function(){return{entityTypes:i["entityTypes"],messageTypes:i["messageTypes"],isJson:!1,isProgress:!1,percent:0,progressDesc:"",form:{entityType:i["entityTypes"].skuIds,messageType:1,skuPool:null},syncForm:{syncMsgTypes:[1,5,6],isGoOn:!1},rules:{skuIds:[{required:!0,message:"请输入商品编码",trigger:"blur"},{pattern:/^(\d+[,])*(\d+)$/,message:"商品编码必须为数字,多个必须使用英文逗号隔开",trigger:"blur"}],contractNO:[{required:!0,message:"请输入合同号",trigger:"blur"}],clientSkuId:[{required:!0,message:"请输入clientSkuId",trigger:"blur"}],status:[{required:!0,type:"number",message:"请选择状态",trigger:"blur"}],messageText:[{required:!0,message:"请输入json格式消息",trigger:"blur"}]},syncRules:{syncMsgTypes:[{required:!0,type:"array",message:"请选择需要全量同步的消息类型",trigger:"blur"}]}}},computed:{hunmanProgressDesc:function(){var e=/(\d+)/g;return this.progressDesc&&this.progressDesc.replace(e,'<span style="color: #57a3f3">$1</span>')}},methods:{changeJsonType:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isJson=e,this.messageTypes=e&&{0:"全部"}||i["messageTypes"],this.$set(this.form,"messageType",e?0:1)},msgTextChange:function(){this.form.messageText&&this.$set(this.form,"messageText",JSON.stringify(JSON.parse(this.form.messageText),null,4))},onOk:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l["n"]("/api/ka/search/component/repair/common",{data:Object(n["a"])({entityType:this.form.entityType,entityId:this.form[Object.keys(i["entityTypes"]).find(function(e){return i["entityTypes"][e]===t.form.entityType})]},this.isJson&&JSON.parse(this.form.messageText)||this.form)});case 2:this.$Message.info("消息发送成功");case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),syncAll:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l["n"]("/api/ka/search/component/repair/syncData",{data:this.syncForm});case 2:this.$Message.info("全量商品同步任务创建成功，请耐心等待任务执行完成"),this.isProgress=!0,setInterval(this.syncProgress,1e3);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),syncProgress:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l["n"]("/api/ka/search/component/repair/syncProgress");case 2:t=e.sent,t.data&&(this.percent=t.data.split("%")[0],this.progressDesc=t.data.split("%")[1],t.data.includes("syncAllTaskClose=true")&&this.tabsChange(i["entityTypes"].sync_all));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),tabsChange:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(i["entityTypes"].sync_all===t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,l["n"]("/api/ka/search/component/repair/lastFailSku");case 4:s=e.sent,this.$set(this.syncForm,"lastSku",s.data[0]),this.$set(this.syncForm,"syncNums",s.data[1]);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),reset:function(){this.form={messageType:1,entityType:this.form.entityType},this.isJson=!1},refreshSkuCategory:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l["n"]("/api/ka/search/component/repair/reFreshAllCategory");case 2:this.$Message.info("全量同步成功");case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}},p=m,u=(s("2b45"),s("2877")),y=Object(u["a"])(p,r,a,!1,null,null,null);y.options.__file="sendMsg.vue";t["default"]=y.exports}}]);